"use strict";(self["webpackChunkkadi_tidi"]=self["webpackChunkkadi_tidi"]||[]).push([[789],{5437:function(e,t,n){n.d(t,{Gk:function(){return l},Qg:function(){return c},TA:function(){return o},V9:function(){return r},gg:function(){return s},jT:function(){return u}});var a=n(5036),i=(n(4369),n(4724));function o(e){return new Promise(((t,n)=>{try{const o={userId:e};a.N.post(`${i.T5}/lobbies/create`,o).then((e=>{t(e)})).catch((e=>{n(e)}))}catch(o){n(o)}}))}function r(e){return new Promise(((t,n)=>{try{if(!e)return n("No lobbyId found");a.N.get(`${i.T5}/lobbies/${e}`).then((e=>{t(e)})).catch((e=>{n(e)}))}catch(o){n(o)}}))}function s(e,t,n){return new Promise(((o,r)=>{try{const{userName:s,email:l}=n,u={sender:t};s?u.receiver={userName:s}:l&&(u.receiver={email:l}),a.N.post(`${i.T5}/lobbies/${e}/invite`,u).then((e=>{o(e)})).catch((e=>{r(e)}))}catch(s){r(s)}}))}function l(e){return new Promise(((t,n)=>{try{const{inviteId:i,lobbyCode:o,userId:r}=e;if(!i&&!o)return n("No inviteId or lobbyCode found");if(o&&!r)return n("No userId found");let s="";const l={};i?s=`/lobbies/invite/${i}`:(s=`/lobbies/code/${o}`,l.userId=r),a.N.post(s,l).then((e=>{t(e)})).catch((e=>{n(e)}))}catch(i){n(i)}}))}function u(e){return new Promise(((t,n)=>{try{if(!e)return n("No inviteId found");a.N.delete(`${i.T5}/lobbies/invite/${e}`).then((e=>{t(e)})).catch((e=>{n(e)}))}catch(o){n(o)}}))}function c(e,t){return new Promise(((n,i)=>{try{if(!e)return i("No Lobby Id found");if(!t)return i("No userId found");a.N.patch(`/lobbies/${e}/leave`,{userId:t}).then((e=>{n(e)})).catch((e=>{i(e)}))}catch(o){i(o)}}))}},8921:function(e,t,n){n.d(t,{$P:function(){return o},Oq:function(){return l},_B:function(){return s},qN:function(){return i},wJ:function(){return r}});var a=n(5036);function i(e,t){return new Promise(((n,i)=>{try{if(!e)return i("No Lobby Id found");a.N.post(`/lobbies/${e}/matches/create`,t).then((e=>{n(e)})).catch((e=>{i(e)}))}catch(o){i(o)}}))}function o(e,t){return new Promise(((n,i)=>{try{if(!e)return i("No lobbyId found");if(!t)return i("No matchId found");a.N.get(`/lobbies/${e}/matches/${t}`).then((e=>{n(e)})).catch((e=>{i(e)}))}catch(o){i(o)}}))}function r(e,t,n){return new Promise(((i,o)=>{try{if(!e)return o("No lobbyId found");if(!t)return o("No matchId found");if(!n)return o("No nextPlayer found");a.N.patch(`/lobbies/${e}/matches/${t}/bid`,n).then((e=>{i(e)})).catch((e=>{o(e)}))}catch(r){o(r)}}))}function s(e,t,n){return new Promise(((i,o)=>{try{if(!e)return o("No lobbyId found");if(!t)return o("No matchId found");if(!n)return o("No nextPlayer found");a.N.patch(`/lobbies/${e}/matches/${t}/setTrumpAndPartner`,n).then((e=>{i(e)})).catch((e=>{o(e)}))}catch(r){o(r)}}))}function l(e,t,n){return new Promise(((i,o)=>{try{if(!e)return o("No lobbyId found");if(!t)return o("No matchId found");if(!n)return o("No nextPlayer found");a.N.patch(`/lobbies/${e}/matches/${t}/play`,n).then((e=>{i(e)})).catch((e=>{o(e)}))}catch(r){o(r)}}))}},9644:function(e,t,n){n.d(t,{Z:function(){return p}});var a=n(3396),i=n(7139),o=n(9242),r=n(4870);const s={class:"assignee-headtitle d-block text-ellipsis text-nowrap"},l={class:"cursor-pointer d-flex align-items-center"},u={key:0,class:"bg-white mobile-list-inputsearch-wrapper border-bottom p-15px"};var c={__name:"Sidebar",props:{title:{type:String,default:"Title"},top:{type:String,default:"46px"},offset:{type:String,default:"0px"},visible:{type:Boolean,default:!0},defaultLayout:{type:Boolean,default:!0},options:{type:Array,default:()=>[]},value:{type:Array,default:()=>[]},left:{type:Boolean,default:!1},className:{type:String,default:""},width:{type:String,default:"374px"},headClass:{type:String,default:""},bodyClass:{type:String,default:""},unMount:{type:Boolean,default:!0},hideHeader:{type:Boolean,default:!1},grouped:{type:Boolean,default:!1},enableSearch:{type:Boolean,default:!1},closeOnBackDrop:{type:Boolean,default:!0},closeOnSelect:{type:Boolean,default:!0},multiSelect:{type:Boolean,default:!1},showClear:{type:Boolean,default:!0},zIndex:{type:Number,default:7},isDefault:{type:Boolean,default:!1},imageDisplayForPriority:{type:Boolean,default:!1}},emits:["update:visible","selected","removed","update:value","clear","searchChange"],setup(e){(0,a.aZ)({name:"Sidebar-Component"});const t=e,n=(0,r.iH)(!1),c=(0,r.iH)(""),d=(0,r.iH)(null),p=(0,r.iH)(!1);return(0,a.bv)((()=>{!0===t.visible&&(p.value=!0,setTimeout((()=>{n.value=!0}),100))})),(0,a.YP)((()=>t.visible),(e=>{t.enableSearch&&t.visible&&(0,a.Y3)((()=>{d.value.focus()})),!1===e?(setTimeout((()=>{p.value=e,c.value=""}),100),n.value=e):(setTimeout((()=>{n.value=e}),100),p.value=e)})),(t,r)=>((0,a.wg)(),(0,a.j4)(a.lR,{to:"#my-sidebar"},[!e.unMount||p.value?((0,a.wg)(),(0,a.iD)("div",{key:0,class:(0,i.C_)(["position-fi justify-content-end sidebar",`${e.className} ${e.left?"flex-row-reverse":""} ${p.value?"d-flex":"d-none"}`]),style:(0,i.j5)([{"z-index":e.zIndex}])},[(0,a._)("div",{class:"back-drop",onClick:r[0]||(r[0]=n=>e.closeOnBackDrop?t.$emit("update:visible",!p.value):"")}),(0,a._)("div",{style:(0,i.j5)(`${e.width?`width: ${e.width}`:""}; top: ${e.top}; height: calc(100% - ${e.top});`),class:(0,i.C_)([{"hide-side-left":!n.value&&e.left,"hide-side-right":!n.value&&!e.left},"position-fi bg-white d-flex flex-column sidebar-content z-index-7"])},[e.hideHeader?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",{key:0,class:(0,i.C_)([e.headClass,"sidebar-head bg-white d-flex align-items-center justify-content-between px-1 blue border-bottom cursor-default"])},[(0,a.WI)(t.$slots,"head",{},(()=>[(0,a._)("div",s,[(0,a.WI)(t.$slots,"head-left",{},(()=>[(0,a.Uk)((0,i.zw)(e.title),1)]))]),(0,a._)("div",null,[(0,a.WI)(t.$slots,"head-mid")]),(0,a._)("div",l,[(0,a.WI)(t.$slots,"head-right",{},(()=>[e.multiSelect&&e.showClear?((0,a.wg)(),(0,a.iD)("button",{key:0,class:(0,i.C_)(["clear-all outline-primary bg-light-gray black mr-1",{"opacity-5 cursor-default":!e.value.length,"opacity-10 cursor-pointer":e.value.length}]),onClick:r[1]||(r[1]=e=>t.$emit("clear"))},"Clear all",2)):(0,a.kq)("",!0),(0,a._)("button",{class:"btn btn-danger",onClick:r[2]||(r[2]=e=>t.$emit("update:visible",!p.value))},"X")]))])]))],2)),(0,a._)("div",{class:(0,i.C_)(["black sidebar-body bg-white style-scroll",e.bodyClass]),style:(0,i.j5)({height:e.hideHeader?"100%":""})},[e.enableSearch?((0,a.wg)(),(0,a.iD)("div",u,[(0,a.wy)((0,a._)("input",{ref_key:"sidebar_search",ref:d,type:"text","onUpdate:modelValue":r[3]||(r[3]=e=>c.value=e),placeholder:"Search",class:"form-control listsidebar-search font-size-16",onInput:r[4]||(r[4]=e=>t.$emit("searchChange",c.value))},null,544),[[o.nr,c.value]])])):(0,a.kq)("",!0),(0,a.WI)(t.$slots,"body",{},(()=>[e.defaultLayout?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"overflow-y-auto sidebar-options overflow-x-hidden",style:(0,i.j5)("height: "+(e.enableSearch?"calc(100% - 52px);":"calc(100% - 0px);"))},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.options,((e,n)=>(0,a.WI)(t.$slots,"options",{key:n,data:e}))),128))],4)):(0,a.kq)("",!0)]))],6)],6)],6)):(0,a.kq)("",!0)]))}};const d=c;var p=d},5789:function(e,t,n){n.r(t),n.d(t,{default:function(){return T}});n(560);var a=n(3396),i=n(7139),o=n(4870),r=n(3535),s=n(5437),l=n(8921),u=n(5451),c=n(2483),d=n(4237),p=n(65),b=n(13),y=n(4724),m=n(9644),h=n(8113);const f={class:"position-re"},v={class:"d-flex align-items-center"},g={class:"d-flex"},w={class:"d-flex align-items-center justify-content-between hover-bg-light-blue",style:{padding:"10px 15px"}},_={class:"text-capitalize"},I=["disabled","onClick"],x={key:1,class:"btn btn-success cursor-default"},N={key:0,class:"btn btn-success cursor-default"},k={key:1,class:"btn btn-secondary cursor-default"};var $={__name:"Lobby",setup(e){const{getters:t}=(0,p.oR)(),n=(0,a.f3)("userId"),$=(0,c.yj)(),C=(0,c.tv)(),T=(0,d.useToast)();(0,a.aZ)({name:"Lobby-Component"});const D=(0,o.iH)(),R=(0,o.iH)([]),S=(0,o.iH)(!1),H=(0,o.iH)(),P=(0,a.Fl)((()=>t["users/friends"]||[]));function B(){return new Promise(((e,t)=>{try{(0,s.V9)($.params?.id).then((a=>{a?.data?a.data?.players.includes(n.value)?(a.data?.activeMatch?C.replace({name:"Match",params:{id:$.params.id,mid:a.data.activeMatch}}):H.value=a.data,e(a.data)):(C.replace({name:"Home"}),t("Invalid lobby")):t("No data found")})).catch((e=>{t(e)}))}catch(a){t(a)}}))}function O(){const e={subCollection:r.H.LOBBIES,watchFilter:{filter:{$or:[{operationType:{$in:["delete"]}},{"fullDocument._id":h.s_.ObjectId($.params.id)}]}}};(0,u.l)(e,(({data:e,type:t,error:a,snap:i})=>{a?console.error("ERROR in watch lobby: ",a):("insert"===t?H.value=e.fullDocument:"update"===t||"replace"===t?(H.value=e.fullDocument,!H.value?.lobbyClosed&&H.value?.players.includes(n.value)||(C.replace({name:"Home"}),i?.return())):"delete"===t&&(C.replace({name:"Home"}),i?.return()),H.value?.activeMatch&&C.replace({name:"Match",params:{id:$.params.id,mid:H.value?.activeMatch}}))}))}function z(){const e={subCollection:r.H.INVITATION,watchFilter:{filter:{$or:[{operationType:{$in:["delete"]}},{"fullDocument.lobbyId":$.params.id,operationType:{$in:["update","insert","replace"]}}]}}};(0,u.l)(e,(({data:e,type:t,error:n,snap:a})=>{if(n)console.error("ERROR in watch invitations: ",n);else if(D.value=a,"inital"===t)(0,b.$)({data:[{lobbyId:$.params.id}],type:"find",collection:r.H.INVITATION}).then((e=>{R.value=e})).catch((e=>{console.error("ERROR in fetch invitations: ",e)}));else if("insert"===t)R.value.push(e.fullDocument);else if("update"===t||"replace"===t){const t=R.value.findIndex((t=>t._id===e.fullDocument?._id));-1!==t?R.value[t]=e.fullDocument:R.value.push(e.fullDocument)}else if("delete"===t){const t=R.value.findIndex((t=>t._id===e.documentKey?._id));-1!==t&&R.value.splice(t,1)}}))}function j(){O(),z()}function M(e){return!!R.value.find((t=>t?.receiverId===e))}function L(e){try{(0,s.gg)($.params.id,n.value,{userName:e.userName}).then((e=>{e.status?T.success(e.data?.statusText,{position:"top-right"}):T.error(e.data?.statusText,{position:"top-right"})})).catch((e=>{console.error("ERROR in invite to lobby: ",e?.response?.data?.statusText||e),T.error(e.response?.data?.statusText||"Something went wrong",{position:"top-right"})}))}catch(t){console.error("ERROR in invite to lobby",t)}}function q(){(0,l.qN)($.params.id,{players:H.value?.players,perPlayerCardsNumber:12}).then((e=>e.data)).then((e=>{e.status?(C.push({name:"Match",params:{id:$.params.id,mid:e.data._id}}),T.success("Match created successfully",{position:"top-right"})):T.error(e.statusText,{position:"top-right"})})).catch((e=>{console.error("ERROR in start match: ",e.response?.data?.statusText||e),T.error(e.response?.data?.statusText||"Something went wrong",{position:"top-right"})}))}function E(){(0,s.Qg)($.params?.id,n.value).then((e=>e.data)).then((e=>{e.status?(T.success("Lobby left",{position:"top-right"}),C.replace({name:"Home"})):T.error(e?.statusText,{position:"top-right"})})).catch((e=>{T.error(e.response?.data?.statusText||"Something went wrong",{position:"top-right"}),console.error("ERROR in leave lobby: ",e)}))}return(0,a.bv)((()=>{B().then((e=>{e&&j()})).catch((e=>{console.error("ERROR in check lobby: ",e),T.error("Invalid lobby",{position:"top-right"}),C.replace({name:"Home"})}))})),(0,a.Jd)((()=>{D.value?.return&&D.value.return()})),(e,t)=>((0,a.wg)(),(0,a.iD)("div",f,[(0,a._)("button",{class:"position-ab btn btn-primary border-right-radius-0",style:{right:"-15px"},onClick:t[0]||(t[0]=e=>S.value=!0)},"<"),(0,a._)("div",null," Lobby - "+(0,i.zw)(e.$route.params?.id),1),(0,a._)("div",v,[H.value?.lobbyLeader===(0,o.SU)(n)?((0,a.wg)(),(0,a.iD)("button",{key:0,class:"btn btn-primary mr-10px",onClick:t[1]||(t[1]=e=>q())},"Start Match")):(0,a.kq)("",!0),(0,a._)("button",{class:"btn btn-primary",onClick:t[2]||(t[2]=e=>E())},"Leave Lobby")]),(0,a._)("div",null,[(0,a._)("div",null," code: "+(0,i.zw)(H.value?.lobbyCode),1),(0,a._)("div",null," players: "+(0,i.zw)(H.value?.players),1),(0,a._)("div",null," number of playerrs: "+(0,i.zw)(H.value?.players?.length),1),(0,a._)("div",null," max players: "+(0,i.zw)((0,o.SU)(y.j)),1),(0,a._)("div",null," Active Match: "+(0,i.zw)(H.value?.activeMatch),1)]),(0,a._)("div",g,[(0,a.Uk)(" INVITES "),(0,a.Wm)(m.Z,{visible:S.value,"onUpdate:visible":t[3]||(t[3]=e=>S.value=e),title:"Friends",options:P.value,offset:"15px",top:"0px"},{options:(0,a.w5)((({data:e})=>[(0,a._)("div",w,[(0,a._)("span",_,(0,i.zw)(e?.userName),1),H.value?.players?.length<(0,o.SU)(y.j)?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[H.value?.players?.includes(e._id)?((0,a.wg)(),(0,a.iD)("button",x," Joined ")):((0,a.wg)(),(0,a.iD)("button",{key:0,class:(0,i.C_)(["btn",{"btn-secondary cursor-default":M(e._id),"btn-primary cursor-pointer":!M(e._id)}]),disabled:M(e._id),onClick:t=>M(e._id)?"":L(e)},(0,i.zw)(M(e._id)?"Requested":"Invite"),11,I))],64)):((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[H.value?.players?.includes(e._id)?((0,a.wg)(),(0,a.iD)("button",N," Joined ")):((0,a.wg)(),(0,a.iD)("button",k," Invite "))],64))])])),_:1},8,["visible","options"]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(R.value,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"m-5px red",key:t},(0,i.zw)(e?.receiver),1)))),128))])]))}};const C=$;var T=C},4369:function(e){e.exports=JSON.parse('[{"type":"spades","number":1,"point":10},{"type":"spades","number":2,"point":0},{"type":"spades","number":3,"point":30},{"type":"spades","number":4,"point":0},{"type":"spades","number":5,"point":5},{"type":"spades","number":6,"point":0},{"type":"spades","number":7,"point":0},{"type":"spades","number":8,"point":0},{"type":"spades","number":9,"point":0},{"type":"spades","number":10,"point":10},{"type":"spades","number":11,"point":10},{"type":"spades","number":12,"point":10},{"type":"spades","number":13,"point":10},{"type":"diamonds","number":1,"point":10},{"type":"diamonds","number":2,"point":0},{"type":"diamonds","number":3,"point":0},{"type":"diamonds","number":4,"point":0},{"type":"diamonds","number":5,"point":5},{"type":"diamonds","number":6,"point":0},{"type":"diamonds","number":7,"point":0},{"type":"diamonds","number":8,"point":0},{"type":"diamonds","number":9,"point":0},{"type":"diamonds","number":10,"point":10},{"type":"diamonds","number":11,"point":10},{"type":"diamonds","number":12,"point":10},{"type":"diamonds","number":13,"point":10},{"type":"clubs","number":1,"point":10},{"type":"clubs","number":2,"point":0},{"type":"clubs","number":3,"point":0},{"type":"clubs","number":4,"point":0},{"type":"clubs","number":5,"point":5},{"type":"clubs","number":6,"point":0},{"type":"clubs","number":7,"point":0},{"type":"clubs","number":8,"point":0},{"type":"clubs","number":9,"point":0},{"type":"clubs","number":10,"point":10},{"type":"clubs","number":11,"point":10},{"type":"clubs","number":12,"point":10},{"type":"clubs","number":13,"point":10},{"type":"hearts","number":1,"point":10},{"type":"hearts","number":2,"point":0},{"type":"hearts","number":3,"point":0},{"type":"hearts","number":4,"point":0},{"type":"hearts","number":5,"point":5},{"type":"hearts","number":6,"point":0},{"type":"hearts","number":7,"point":0},{"type":"hearts","number":8,"point":0},{"type":"hearts","number":9,"point":0},{"type":"hearts","number":10,"point":10},{"type":"hearts","number":11,"point":10},{"type":"hearts","number":12,"point":10},{"type":"hearts","number":13,"point":10}]')}}]);
//# sourceMappingURL=789.b312d4fc.js.map